<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>A-Frame Room Component - Basic</title>
    <meta name="description" content="Basic example for Room component."></meta>
    <script src="aframe-master.js"></script>
  </head>
  <body>
    <a-scene>
      
      <a-assets>
        
        <img id="testTex" src="test.png">
        
        <a-mixin id="floorMat" material="color:#BBB"></a-mixin>
        
        <img crossorigin="anonymous" id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg">
        <img crossorigin="anonymous" id="skyTexture" src="https://cdn.aframe.io/a-painter/images/sky.jpg">
        
      </a-assets>

    <!-- Floor -->
    <a-plane
      position="0 0 0"
      rotation="-90 0 0"
      width="10"
      height="10"
      color="#888"
    ></a-plane>

    <!-- Ceiling -->
    <a-plane
      position="0 5 0"
      rotation="90 0 0"
      width="10"
      height="10"
      color="#888"
    ></a-plane>

    <!-- Back Wall -->
    <a-plane
      position="0 2.5 -5"
      width="10"
      height="5"
      color="#ccc"
    ></a-plane>

    <!-- Left Wall -->
    <a-plane
      position="-5 2.5 0"
      rotation="0 90 0"
      width="10"
      height="5"
      color="#ccc"
    ></a-plane>

    <!-- Right Wall -->
    <a-plane
      position="5 2.5 0"
      rotation="0 90 0"
      width="10"
      height="5"
      color="#ccc"
    ></a-plane>

    <!-- Front Wall (with Entry) -->
    <a-entity position="0 2.5 5">
      <!-- Left Part of Front Wall -->
      <a-plane
        position="-2.5 0 0"
        rotation="0 180 0"
        width="5"
        height="5"
        color="#ccc"
      ></a-plane>
      <!-- Right Part of Front Wall -->
      <a-plane
        position="2.5 0 0"
        rotation="0 180 0"
        width="5"
        height="5"
        color="#ccc"
      ></a-plane>
      <!-- Top Part of Front Wall -->
      <a-plane
        position="0 1.25 0"
        rotation="0 180 0"
        width="10"
        height="2.5"
        color="#ccc"
      ></a-plane>
    </a-entity>

    <!-- Lighting -->
    <a-entity
      light="type: directional; color: #fff; intensity: 1"
      position="5 5 5"
    ></a-entity>
    <a-entity
      light="type: ambient; color: #404040"
    ></a-entity>

    <!-- Player -->
    <a-entity
      id="player"
      movement-controls="speed: 0.1"
      position="0 1.6 0"
    >
    </a-entity>

<a-entity camera look-controls wasd-controls="acceleration:100" position="0 1.6 0"></a-entity>

    <!-- Controller -->
    <a-entity
      id="right-hand"
      hand-controls="hand: right"
      oculus-touch-controls="hand: right"
    ></a-entity>

    <!-- Square Template (hidden initially) -->
    <a-entity id="square-template" visible="false">
      <a-box
        position="0 0 -1"
        width="0.5"
        height="0.5"
        depth="0.5"
        color="red"
      ></a-box>
    </a-entity>

    <!-- Event Listener for Button Press -->
    <a-entity>
      <a-animation
        id="button-press-animation"
        attribute="visible"
        begin="button-press"
        from="false"
        to="true"
      ></a-animation>
    </a-entity>

    <!-- Script to Handle Button Press -->
    <script>
      const rightHand = document.querySelector('#right-hand');
      const squareTemplate = document.querySelector('#square-template');

      rightHand.addEventListener('abuttondown', () => {
        // Clone the square template
        const square = squareTemplate.cloneNode(true);
        square.setAttribute('visible', true);

        // Position the square in front of the controller
        const controllerPosition = rightHand.getAttribute('position');
        const controllerRotation = rightHand.getAttribute('rotation');
        square.setAttribute('position', {
          x: controllerPosition.x,
          y: controllerPosition.y,
          z: controllerPosition.z - 1
        });
        square.setAttribute('rotation', controllerRotation);

        // Add the square to the scene
        square.removeAttribute('id'); // Remove the template ID
        document.querySelector('a-scene').appendChild(square);
      });
    </script>

      
      <a-sky height="2048" radius="30" src="#skyTexture" theta-length="90" width="2048" segments-height="5" segments-width="8"></a-sky>
      <a-plane src="#groundTexture" rotation="-90 0 0" position="0 -0.01 0" height="100" width="100"></a-plane>
      
      <a-light type="directional" intensity="0.2" position="-1 -2  2"></a-light>
      <a-light type="directional" intensity="0.3" position=" 2  1 -1"></a-light>
    </a-scene>
</body>
</html>
